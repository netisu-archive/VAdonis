<script setup lang="ts">
import Navbar from '@/Components/LayoutParts/Navbar.vue';
import Sidebar from '@/Components/LayoutParts/Sidebar.vue';
import Footer from '@/Components/LayoutParts/Footer.vue';
import DeleteUserForm from './Partials/DeleteUserForm.vue';
import UpdatePasswordForm from './Partials/UpdatePasswordForm.vue';
import UpdateProfileInformationForm from './Partials/UpdateProfileInformationForm.vue';
import { Head } from '@inertiajs/vue3';

defineProps({
    mustVerifyEmail: Boolean,
    status: String,
});

function showModal(modalId: string): void {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.classList.toggle("active");
    }
};
</script>

<template>
   <Navbar/>
	<Sidebar>
        <div class="modal" id="email-modal">
            <div class="modal-card modal-card-body modal-card-sm">
                <div class="section-borderless">
                    <div
                        class="gap-2 align-middle flex-container align-justify"
                    >
                        <div class="text-lg fw-semibold">Change Email</div>
                        <button
                        @click="showModal('email-modal')"
                            class="btn-circle"
                            data-toggle-modal="#email-modal"
                            style="margin-right: -10px"
                        >
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="section-borderless">
                    <div class="mb-2">
                        <div class="text-xs fw-bold text-muted text-uppercase">
                            New Email
                        </div>
                        <input
                            type="text"
                            class="form"
                            placeholder="New Email..."
                        />
                    </div>
                    <div class="mb-2">
                        <div class="text-xs fw-bold text-muted text-uppercase">
                            Password
                        </div>
                        <input
                            type="password"
                            class="form"
                            placeholder="Password..."
                        />
                    </div>
                    <div class="text-xs text-muted fw-semibold">
                        After changing your email address, a confirmation email
                        will be sent to your inbox to confirm your identity.
                    </div>
                </div>
                <div
                    class="flex-wrap gap-2 flex-container justify-content-end section-borderless"
                >
                    <button
                        class="btn btn-secondary"
                        @click="showModal('email-modal')"
                    >
                        Cancel
                    </button>
                    <input
                        type="submit"
                        class="btn btn-success"
                        value="Change Email"
                    />
                </div>
            </div>
        </div>
        <div class="modal" id="username-modal">
            <div class="modal-card modal-card-body modal-card-sm">
                <div class="section-borderless">
                    <div
                        class="gap-2 align-middle flex-container align-justify"
                    >
                        <div class="text-lg fw-semibold">Change Username</div>
                        <button
                        @click="showModal('username-modal')"
                            class="btn-circle"
                            data-toggle-modal="#username-modal"
                            style="margin-right: -10px"
                        >
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="section-borderless">
                    <div class="mb-2">
                        <div class="text-xs fw-bold text-danger text-uppercase">
                            Username
                        </div>
                        <input
                            type="text"
                            class="form"
                            placeholder="New Username..."
                        />
                        <div class="text-xs text-danger fw-semibold">
                            This username is already taken. Try @Nabrious123
                            instead.
                        </div>
                    </div>
                    <div class="mb-2">
                        <div class="text-xs fw-bold text-muted text-uppercase">
                            Password
                        </div>
                        <input
                            type="password"
                            class="form"
                            placeholder="Password..."
                        />
                    </div>
                    <div class="text-xs text-muted fw-semibold">
                        Changing your username costs<span
                            class="mx-1 text-success"
                            ><i class="fas fa-money-bill-1-wave"></i> {{$page.props.site.price.username}}</span
                        >.
                    </div>
                </div>
                <div
                    class="flex-wrap gap-2 flex-container justify-content-end section-borderless"
                >
                    <button
                        class="btn btn-secondary"
                        @click="showModal('username-modal')"
                    >
                        Cancel
                    </button>
                    <input
                        type="submit"
                        class="btn btn-success"
                        value="Change Username"
                    />
                </div>
            </div>
        </div>
        <div class="modal" id="displayname-modal">
            <div class="modal-card modal-card-body modal-card-sm">
                <div class="section-borderless">
                    <div
                        class="gap-2 align-middle flex-container align-justify"
                    >
                        <div class="text-lg fw-semibold">
                            Change Display Name
                        </div>
                        <button
                            class="btn-circle"
                            @click="showModal('displayname-modal')"
                            style="margin-right: -10px"
                        >
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="section-borderless">
                    <div class="text-xs fw-bold text-muted text-uppercase">
                        New Display Name
                    </div>
                    <input
                        type="text"
                        class="mb-2 form"
                        placeholder="New Display Name..."
                    />
                    <div class="text-xs fw-bold text-muted text-uppercase">
                        Password
                    </div>
                    <input
                        type="password"
                        class="mb-2 form"
                        placeholder="Password..."
                    />
                    <div class="text-xs text-muted fw-semibold">
                        Changing your your display name is free but can only be
                        done once every two weeks.
                    </div>
                </div>
                <div
                    class="flex-wrap gap-2 flex-container justify-content-end section-borderless"
                >
                    <button
                        class="btn btn-secondary"
                        @click="showModal('displayname-modal')"
                    >
                        Cancel
                    </button>
                    <input
                        type="submit"
                        class="btn btn-success"
                        value="Change Display Name"
                    />
                </div>
            </div>
        </div>

                <div class="cell medium-3">
                    <div class="mb-2 text-xl fw-semibold">Account Settings</div>
                    <ul class="tabs flex-dir-column">
                        <li class="tab-item">
                            <a href="#" class="tab-link active squish"
                                >General</a
                            >
                        </li>
                        <li class="tab-item">
                            <a href="#" class="tab-link squish"
                                >Security & Privacy</a
                            >
                        </li>
                        <li class="tab-item">
                            <a href="#" class="tab-link squish">Billing</a>
                        </li>
                    </ul>
                </div>
                <div class="cell medium-8">
                    <div
                        class="mb-3 text-center alert alert-success fw-semibold"
                    >
                        Username Successfully Changed
                    </div>
                    <div class="mb-1 text-xl fw-semibold">General</div>
                    <div class="section-borderless">
                        <div class="card card-body">
                            <div class="mb-2 text-xl fw-semibold">
                                Account Information
                            </div>
                            <div class="section-borderless">
                                <div class="grid-x grid-margin-x">
                                    <div class="mb-3 cell medium-6">
                                        <div
                                            class="gap-2 align-middle card card-body card-inner flex-container align-justify h-100"
                                        >
                                            <div class="min-w-0">
                                                <div
                                                    class="text-xs text-truncate fw-bold text-muted text-uppercase"
                                                >
                                                    User ID
                                                </div>
                                                <div
                                                    class="text-truncate fw-semibold"
                                                >
                                                    {{ $page.props.auth.user.id }}
                                                </div>
                                            </div>
                                            <DeleteUserForm/>
                                        </div>
                                    </div>
                                    <div class="mb-3 cell medium-6">
                                        <div
                                            class="gap-2 align-middle card card-body card-inner flex-container align-justify"
                                        >
                                            <div class="min-w-0">
                                                <div
                                                    class="text-xs text-truncate fw-bold text-muted text-uppercase"
                                                >
                                                    Username
                                                </div>
                                                <div
                                                    class="text-truncate fw-semibold"
                                                >
                                                {{ '@' + $page.props.auth.user.username }}
                                                </div>
                                            </div>
                                            <button
                                                class="btn btn-info btn-circle"
                                                @click="showModal('username-modal')"
                                            >
                                                <i class="fas fa-pencil"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="mb-3 cell medium-6">
                                        <div
                                            class="gap-2 align-middle card card-body card-inner flex-container align-justify"
                                        >
                                            <div class="min-w-0">
                                                <div
                                                    class="text-xs text-truncate fw-bold text-muted text-uppercase"
                                                >
                                                    Display Name
                                                </div>
                                                <div
                                                    class="text-truncate fw-semibold"
                                                >
                                                {{ $page.props.auth.user.display_name }}
                                                </div>
                                            </div>
                                            <button
                                                class="btn btn-info btn-circle"
                                                @click="showModal('displayname-modal')"
                                            >
                                                <i class="fas fa-pencil"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="mb-3 cell medium-6">
                                        <div
                                            class="gap-2 align-middle card card-body card-inner flex-container align-justify"
                                        >
                                            <div class="min-w-0">
                                                <div
                                                    class="text-xs text-truncate fw-bold text-muted text-uppercase"
                                                >
                                                    Email Address<span
                                                        style="font-size: 10px"
                                                        class="text-success ms-2"
                                                        ><i
                                                            class="fas fa-check me-1"
                                                        ></i
                                                        >Verified</span
                                                    >
                                                    <!-- <span style="font-size: 10px;" class="text-danger ms-2"><i class="fas fa-times me-1"></i>Unverified</span> -->
                                                </div>
                                                <div
                                                    class="text-truncate fw-semibold"
                                                >
                                                {{ $page.props.auth.user.email }}
                                                </div>
                                            </div>
                                            <button
                                                class="btn btn-info btn-circle"
                                                @click="showModal('email-modal')"
                                            >
                                                <i class="fas fa-pencil"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="mb-3 cell medium-6">
                                        <div
                                            class="gap-2 align-middle card card-body card-inner flex-container align-justify"
                                        >
                                            <div class="min-w-0">
                                                <div
                                                    class="text-xs text-truncate fw-bold text-muted text-uppercase"
                                                >
                                                    Date of Birth
                                                </div>
                                                <div
                                                    class="text-truncate fw-semibold"
                                                >
                                                {{ $page.props.auth.user.birthdate }}
                                                </div>
                                                <div
                                                    class="text-xs fw-semibold text-muted"
                                                >
                                                    If you want to change your
                                                    date of birth,
                                                    <a href="#"
                                                        >contact support</a
                                                    >.
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div
                                    class="text-xs fw-bold text-muted text-uppercase"
                                >
                                    About You
                                </div>
                                <div class="mb-3 position-relative">
                                    <textarea
                                        class="form form-has-button pe-5"
                                        rows="5"
                                    >{{ $page.props.auth.user.about_me }}</textarea
                                    >
                                    <input
                                        type="button"
                                        class="btn btn-success btn-sm"
                                        value="Update"
                                        style="
                                            position: absolute;
                                            bottom: 10px;
                                            right: 10px;
                                        "
                                    />
                                </div>
                                <div
                                    class="text-xs fw-bold text-muted text-uppercase"
                                >
                                    Forum Signature
                                </div>
                                <div class="gap-2 align-middle flex-container">
                                    <input
                                        type="text"
                                        class="form form-sm btn-sm"
                                        :value="$page.props.auth.user.Signature"
                                    />
                                    <input
                                        type="submit"
                                        class="btn btn-success btn-sm"
                                        value="Update"
                                    />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="section-borderless">
                        <div class="card card-body">
                            <div class="mb-2 text-xl fw-semibold">
                                Website Theme
                            </div>
                            <div  id="theme-switcher-container" class="grid-x grid-margin-x grid-padding-y">
                                <div class="cell large-6">
                                    <div
                                        class="mb-2 theme-selection squish card card-body card-inner mb-lg-0"
                                        id="light-theme-btn"
                                        @click="setTheme('light')"
                                    >
                                        <div
                                            class="gap-4 align-middle flex-container"
                                        >
                                            <div
                                                class="selection-circle flex-child-grow show-for-large"
                                            ></div>
                                            <div
                                                class="gap-1 align-middle flex-container flex-dir-column"
                                                style="min-width: 0"
                                            >
                                                <div
                                                    class="theme-circle light"
                                                ></div>
                                                <div
                                                    class="text-lg fw-semibold text-truncate"
                                                >
                                                    Light Theme
                                                </div>
                                                <div
                                                    class="selection-circle flex-child-grow show-for-small hide-for-large"
                                                ></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="cell large-6">
                                    <div
                                        class="theme-selection squish card card-body card-inner"
                                        id="dark-theme-btn"
                                        @click="setTheme('dark')"
                                    >
                                        <div
                                            class="gap-4 align-middle flex-container"
                                        >
                                            <div
                                                class="selection-circle flex-child-grow show-for-large"
                                            ></div>
                                            <div
                                                class="gap-1 align-middle flex-container flex-dir-column"
                                            >
                                                <div
                                                    class="theme-circle dark"
                                                ></div>
                                                <div
                                                    class="text-lg fw-semibold text-truncate"
                                                >
                                                    Dark Theme
                                                </div>
                                                <div
                                                    class="selection-circle flex-child-grow show-for-small hide-for-large"
                                                ></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div  id="theme-switcher-container" class="grid-x grid-margin-x grid-padding-y">
                                <div class="cell large-6">
                                    <div
                                        class="mb-2 theme-selection squish card card-body card-inner mb-lg-0"
                                        id="amoled-theme-btn"
                                        @click="setTheme('amoled')"
                                    >
                                        <div
                                            class="gap-4 align-middle flex-container"
                                        >
                                            <div
                                                class="selection-circle flex-child-grow show-for-large"
                                            ></div>
                                            <div
                                                class="gap-1 align-middle flex-container flex-dir-column"
                                                style="min-width: 0"
                                            >
                                                <div
                                                    class="theme-circle amoled"
                                                ></div>
                                                <div
                                                    class="text-lg fw-semibold text-truncate"
                                                >
                                                Amoled Theme
                                                </div>
                                                <div
                                                    class="selection-circle flex-child-grow show-for-small hide-for-large"
                                                ></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="cell large-6">
                                    <div
                                        class="theme-selection squish card card-body card-inner"
                                        id="discord-theme-btn"
                                        @click="setTheme('discord')"
                                    >
                                        <div
                                            class="gap-4 align-middle flex-container"
                                        >
                                            <div
                                                class="selection-circle flex-child-grow show-for-large"
                                            ></div>
                                            <div
                                                class="gap-1 align-middle flex-container flex-dir-column"
                                            >
                                                <div
                                                    class="theme-circle discord"
                                                ></div>
                                                <div
                                                    class="text-lg fw-semibold text-truncate"
                                                >
                                                Discord Theme
                                                </div>
                                                <div
                                                    class="selection-circle flex-child-grow show-for-small hide-for-large"
                                                ></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div  id="theme-switcher-container" class="grid-x grid-margin-x grid-padding-y">
                                <div class="cell large-6">
                                    <div
                                        class="mb-2 theme-selection squish card card-body card-inner mb-lg-0"
                                        id="amoled-theme-btn"
                                        @click="setTheme('halloween')"
                                    >
                                        <div
                                            class="gap-4 align-middle flex-container"
                                        >
                                            <div
                                                class="selection-circle flex-child-grow show-for-large"
                                            ></div>
                                            <div
                                                class="gap-1 align-middle flex-container flex-dir-column"
                                                style="min-width: 0"
                                            >
                                                <div
                                                    class="theme-circle amoled"
                                                ></div>
                                                <div
                                                    class="text-lg fw-semibold text-truncate"
                                                >
                                                Halloween Theme
                                                </div>
                                                <div
                                                    class="selection-circle flex-child-grow show-for-small hide-for-large"
                                                ></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="cell large-6">
                                    <div
                                        class="theme-selection squish card card-body card-inner"
                                        id="discord-theme-btn"
                                        @click="setTheme('xmas')"
                                    >
                                        <div
                                            class="gap-4 align-middle flex-container"
                                        >
                                            <div
                                                class="selection-circle flex-child-grow show-for-large"
                                            ></div>
                                            <div
                                                class="gap-1 align-middle flex-container flex-dir-column"
                                            >
                                                <div
                                                    class="theme-circle discord"
                                                ></div>
                                                <div
                                                    class="text-lg fw-semibold text-truncate"
                                                >
                                                Xmas Theme
                                                </div>
                                                <div
                                                    class="selection-circle flex-child-grow show-for-small hide-for-large"
                                                ></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
    </Sidebar>
    <Footer/>
</template>

<script lang="ts">
export default {
  data() {
    return {
      activeTheme: '',
    };
  },
  mounted() {
    const theme = localStorage.getItem('theme') || 'light';
    this.activeTheme = theme;
    this.applyTheme(theme);

    const lightThemeBtn = document.getElementById('light-theme-btn');
    const darkThemeBtn = document.getElementById('dark-theme-btn');
    const amoledThemeBtn = document.getElementById('amoled-theme-btn');
    const discordThemeBtn = document.getElementById('discord-theme-btn');

    if (lightThemeBtn && darkThemeBtn && amoledThemeBtn && discordThemeBtn) {
      lightThemeBtn.classList.remove('active');
      darkThemeBtn.classList.remove('active');
      amoledThemeBtn.classList.remove('active');
      discordThemeBtn.classList.remove('active');

      if (theme === 'light') {
        lightThemeBtn.classList.add('active');
      } else if (theme === 'dark') {
        darkThemeBtn.classList.add('active');
      }else if (theme === 'amoled') {
        amoledThemeBtn.classList.add('active');
      }else if (theme === 'discord') {
        discordThemeBtn.classList.add('active');
      }
    }
  },
  methods: {
    applyTheme(theme) {
      let style = document.getElementById('theme-style');

      if (!style) {
        style = document.createElement('link');
        style.id = 'theme-style';
        style.rel = 'stylesheet';
        document.head.appendChild(style);
      }

      style.href = `/assets/css/themes/variables-${theme}.css`;

      // Save the selected theme in localStorage
      localStorage.setItem('theme', theme);
    },
    setTheme(theme) {
      this.activeTheme = theme;
      this.applyTheme(theme);

      const lightThemeBtn = document.getElementById('light-theme-btn');
      const darkThemeBtn = document.getElementById('dark-theme-btn');
      const amoledThemeBtn = document.getElementById('amoled-theme-btn');
      const discordThemeBtn = document.getElementById('discord-theme-btn');

      if (lightThemeBtn && darkThemeBtn && amoledThemeBtn && discordThemeBtn) {
      lightThemeBtn.classList.remove('active');
      darkThemeBtn.classList.remove('active');
      amoledThemeBtn.classList.remove('active');
      discordThemeBtn.classList.remove('active');

      if (theme === 'light') {
        lightThemeBtn.classList.add('active');
      } else if (theme === 'dark') {
        darkThemeBtn.classList.add('active');
      }else if (theme === 'amoled') {
        amoledThemeBtn.classList.add('active');
      }else if (theme === 'discord') {
        discordThemeBtn.classList.add('active');
      }
      }
    },
  },
};
</script>
